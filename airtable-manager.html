<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Airtable Manager</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #2563eb;
      --secondary: #1e40af;
      --accent: #f59e0b;
      --text: #1f2937;
      --light: #f3f4f6;
      --success: #10b981;
      --danger: #ef4444;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
      color: var(--text);
      min-height: 100vh;
      padding: 2rem;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .title {
      font-size: 2rem;
      color: var(--primary);
    }

    .add-button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 10px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .add-button:hover {
      background: var(--secondary);
    }

    .tables-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .table-card {
      background: white;
      border-radius: 15px;
      padding: 1.5rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .table-name {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--primary);
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .action-button {
      padding: 0.5rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .edit-button {
      background: var(--light);
      color: var(--text);
    }

    .delete-button {
      background: var(--danger);
      color: white;
    }

    .fields-list {
      list-style: none;
    }

    .field-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      border-bottom: 1px solid var(--light);
    }

    .field-item:last-child {
      border-bottom: none;
    }

    .field-name {
      font-weight: 500;
    }

    .field-type {
      color: #6b7280;
      font-size: 0.875rem;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      align-items: center;
      justify-content: center;
    }

    .modal.show {
      display: flex;
    }

    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .close-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid var(--light);
      border-radius: 10px;
      font-size: 1rem;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--primary);
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .cancel-button {
      background: var(--light);
      color: var(--text);
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 10px;
      font-weight: 500;
      cursor: pointer;
    }

    .save-button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 10px;
      font-weight: 500;
      cursor: pointer;
    }

    .save-button:hover {
      background: var(--secondary);
    }

    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      padding: 1rem 2rem;
      border-radius: 10px;
      color: white;
      font-weight: 500;
      display: none;
    }

    .toast.success {
      background: var(--success);
    }

    .toast.error {
      background: var(--danger);
    }

    .toast.show {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="title">Airtable Manager</h1>
      <button class="add-button" id="addTableButton">Add New Table</button>
    </div>

    <div class="tables-grid" id="tablesGrid">
      <!-- Tables will be dynamically added here -->
    </div>
  </div>

  <!-- Add/Edit Table Modal -->
  <div class="modal" id="tableModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Add New Table</h2>
        <button class="close-button">&times;</button>
      </div>
      <form id="tableForm">
        <div class="form-group">
          <label>Table Name</label>
          <input type="text" name="tableName" required>
        </div>
        <div class="form-group">
          <label>Description</label>
          <input type="text" name="description">
        </div>
        <div class="modal-actions">
          <button type="button" class="cancel-button">Cancel</button>
          <button type="submit" class="save-button">Save Table</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add/Edit Field Modal -->
  <div class="modal" id="fieldModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Add New Field</h2>
        <button class="close-button">&times;</button>
      </div>
      <form id="fieldForm">
        <div class="form-group">
          <label>Field Name</label>
          <input type="text" name="fieldName" required>
        </div>
        <div class="form-group">
          <label>Field Type</label>
          <select name="fieldType" required>
            <option value="text">Text</option>
            <option value="number">Number</option>
            <option value="date">Date</option>
            <option value="boolean">Boolean</option>
            <option value="select">Select</option>
            <option value="multiselect">Multi-select</option>
            <option value="link">Link</option>
          </select>
        </div>
        <div class="modal-actions">
          <button type="button" class="cancel-button">Cancel</button>
          <button type="submit" class="save-button">Save Field</button>
        </div>
      </form>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // State management
    let currentTable = null;
    let tables = [];

    // DOM Elements
    const tablesGrid = document.getElementById('tablesGrid');
    const tableModal = document.getElementById('tableModal');
    const fieldModal = document.getElementById('fieldModal');
    const tableForm = document.getElementById('tableForm');
    const fieldForm = document.getElementById('fieldForm');
    const toast = document.getElementById('toast');

    // Event Listeners
    document.getElementById('addTableButton').addEventListener('click', () => {
      showModal(tableModal);
    });

    document.querySelectorAll('.close-button').forEach(button => {
      button.addEventListener('click', () => {
        hideModal(tableModal);
        hideModal(fieldModal);
      });
    });

    document.querySelectorAll('.cancel-button').forEach(button => {
      button.addEventListener('click', () => {
        hideModal(tableModal);
        hideModal(fieldModal);
      });
    });

    tableForm.addEventListener('submit', handleTableSubmit);
    fieldForm.addEventListener('submit', handleFieldSubmit);

    // Functions
    function showModal(modal) {
      modal.classList.add('show');
    }

    function hideModal(modal) {
      modal.classList.remove('show');
    }

    function showToast(message, type = 'success') {
      toast.textContent = message;
      toast.className = `toast ${type} show`;
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    function renderTables() {
      tablesGrid.innerHTML = tables.map(table => `
        <div class="table-card">
          <div class="table-header">
            <h3 class="table-name">${table.name}</h3>
            <div class="table-actions">
              <button class="action-button edit-button" onclick="editTable('${table.id}')">
                Edit
              </button>
              <button class="action-button delete-button" onclick="deleteTable('${table.id}')">
                Delete
              </button>
            </div>
          </div>
          <ul class="fields-list">
            ${table.fields.map(field => `
              <li class="field-item">
                <div>
                  <span class="field-name">${field.name}</span>
                  <span class="field-type">${field.type}</span>
                </div>
                <div class="table-actions">
                  <button class="action-button edit-button" onclick="editField('${table.id}', '${field.id}')">
                    Edit
                  </button>
                  <button class="action-button delete-button" onclick="deleteField('${table.id}', '${field.id}')">
                    Delete
                  </button>
                </div>
              </li>
            `).join('')}
          </ul>
          <button class="add-button" onclick="addField('${table.id}')" style="margin-top: 1rem;">
            Add Field
          </button>
        </div>
      `).join('');
    }

    async function handleTableSubmit(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const tableData = {
        name: formData.get('tableName'),
        description: formData.get('description'),
        fields: []
      };

      try {
        // Here you would make an API call to Airtable
        const newTable = {
          id: Date.now().toString(),
          ...tableData
        };
        tables.push(newTable);
        renderTables();
        hideModal(tableModal);
        showToast('Table created successfully');
      } catch (error) {
        showToast('Error creating table', 'error');
      }
    }

    async function handleFieldSubmit(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const fieldData = {
        name: formData.get('fieldName'),
        type: formData.get('fieldType')
      };

      try {
        // Here you would make an API call to Airtable
        const table = tables.find(t => t.id === currentTable);
        if (table) {
          table.fields.push({
            id: Date.now().toString(),
            ...fieldData
          });
          renderTables();
          hideModal(fieldModal);
          showToast('Field added successfully');
        }
      } catch (error) {
        showToast('Error adding field', 'error');
      }
    }

    function editTable(tableId) {
      const table = tables.find(t => t.id === tableId);
      if (table) {
        const form = tableForm;
        form.tableName.value = table.name;
        form.description.value = table.description;
        currentTable = tableId;
        showModal(tableModal);
      }
    }

    function deleteTable(tableId) {
      if (confirm('Are you sure you want to delete this table?')) {
        tables = tables.filter(t => t.id !== tableId);
        renderTables();
        showToast('Table deleted successfully');
      }
    }

    function addField(tableId) {
      currentTable = tableId;
      fieldForm.reset();
      showModal(fieldModal);
    }

    function editField(tableId, fieldId) {
      const table = tables.find(t => t.id === tableId);
      const field = table?.fields.find(f => f.id === fieldId);
      if (field) {
        const form = fieldForm;
        form.fieldName.value = field.name;
        form.fieldType.value = field.type;
        currentTable = tableId;
        showModal(fieldModal);
      }
    }

    function deleteField(tableId, fieldId) {
      if (confirm('Are you sure you want to delete this field?')) {
        const table = tables.find(t => t.id === tableId);
        if (table) {
          table.fields = table.fields.filter(f => f.id !== fieldId);
          renderTables();
          showToast('Field deleted successfully');
        }
      }
    }

    // Initialize with some sample data
    tables = [
      {
        id: '1',
        name: 'Flights',
        description: 'Flight information',
        fields: [
          { id: '1', name: 'Flight Number', type: 'text' },
          { id: '2', name: 'Departure Time', type: 'date' },
          { id: '3', name: 'Price', type: 'number' }
        ]
      },
      {
        id: '2',
        name: 'Bookings',
        description: 'Booking information',
        fields: [
          { id: '4', name: 'Booking ID', type: 'text' },
          { id: '5', name: 'Customer Name', type: 'text' },
          { id: '6', name: 'Status', type: 'select' }
        ]
      }
    ];

    renderTables();
  </script>
</body>
</html> 